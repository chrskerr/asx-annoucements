{"version":3,"sources":["Home.js","App.js","webpack:///./src/index.js?b635"],"names":["SUBSCRIPTION","gql","Home","useState","JSON","parse","localStorage","getItem","savedData","setSavedData","is_price_sensitive","set_is_price_sensitive","is_asx_300","set_is_asx_300","is_after_4pm_yesterday","set_is_after_4pm_yesterday","time_before","formatISO","set","subBusinessDays","Date","hours","minutes","seconds","useSubscription","variables","data","loading","announcements","_","get","annoucementsWithSavedData","map","announcement","id","read","saved","unread","filter","useEffect","setItem","stringify","className","type","checked","onChange","disabled","icon","faSpinner","spin","size","faCheck","isEmpty","el","key","RowCard","description","hotcopper_url","stock","time","name","ticker","GICS","markRead","parsedTime","parseJSON","formatDistanceToNow","format","href","target","rel","onClick","faExternalLinkAlt","App","httpLink","HttpLink","uri","wsLink","WebSocketLink","options","reconnect","timeout","link","split","query","getMainDefinition","kind","operation","client","ApolloClient","cache","InMemoryCache","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.41b9e8ad.chunk.js","sourcesContent":["\nimport React, { useState, useEffect } from \"react\";\nimport PropTypes from \"proptypes\";\nimport { useSubscription } from \"@apollo/react-hooks\";\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\nimport { faSpinner, faCheck, faExternalLinkAlt } from \"@fortawesome/free-solid-svg-icons\";\nimport _ from \"lodash\";\nimport gql from \"graphql-tag\";\nimport { parseJSON, format, formatDistanceToNow, subBusinessDays, set, formatISO } from \"date-fns\";\n\nconst SUBSCRIPTION = gql`\nsubscription SubcribeAnnouncements ( $time_before: timestamptz!, $is_price_sensitive: Boolean!, $is_asx_300: Boolean! ) {\n    announcements( where: { \n        time: { _gte: $time_before },\n        is_price_sensitive: { _eq: $is_price_sensitive }, \n        stock: { is_asx_300: { _eq: $is_asx_300 }}\n    }) {\n        ann_download_url\n        description\n        hotcopper_url\n        id time\n        is_price_sensitive\n        stock {\n            name ticker\n            is_asx_300 GICS\n        }\n    }\n}`;\n\n\nexport default function Home () {\n\tconst [ savedData, setSavedData ] = useState( JSON.parse( localStorage.getItem( \"savedData\" )));\n\tconst [ is_price_sensitive, set_is_price_sensitive ] = useState( true );\n\tconst [ is_asx_300, set_is_asx_300 ] = useState( true );\n\tconst [ is_after_4pm_yesterday, set_is_after_4pm_yesterday ] = useState( true );\n\n\tconst time_before = is_after_4pm_yesterday ? formatISO( set( subBusinessDays( new Date(), 1 ), { hours: 16, minutes: 0, seconds: 0 })) : formatISO( 0 );\n\n\tconst { data, loading } = useSubscription( SUBSCRIPTION, { variables: { is_price_sensitive, is_asx_300, time_before }});\n\n\tconst announcements = _.get( data, \"announcements\" );\n\tconst annoucementsWithSavedData = _.map( announcements, announcement => {\n\t\tconst { id } = announcement;\n\t\treturn {\n\t\t\t...announcement,\n\t\t\tread: _.get( savedData, [ id, \"read\" ], false ),\n\t\t\tsaved: _.get( savedData,[ id, \"saved\" ], false ),\n\t\t};});\n\n\tconst unread = _.filter( annoucementsWithSavedData, { read: false, saved: false });\n\tconst saved = _.filter( annoucementsWithSavedData, { saved: true });\n\tconst read = _.filter( annoucementsWithSavedData, { read: true, saved: false });\n\n\tuseEffect(() => {\n\t\tif ( !savedData ) setSavedData({});\n\t\tlocalStorage.setItem( \"savedData\", JSON.stringify( savedData ));\n\t}, [ savedData ]);\n\n\treturn (\n\t\t<div className=\"body\">\n\t\t\t<div className=\"header\">\n\t\t\t\t<h2>ASX Recent Announcement Feed</h2>\n\t\t\t\t<p>A scraped collection of ASX announcements, data updated every 10 mins.</p>\n\t\t\t</div>\n\t\t\t<div className=\"flex-box\">\n\t\t\t\t<div>\n\t\t\t\t\t<label>Price sensitive only?</label>\n\t\t\t\t\t<input type=\"checkbox\" checked={ is_price_sensitive } onChange={ () => set_is_price_sensitive( !is_price_sensitive ) } disabled={ loading } />\n\t\t\t\t</div>\n\t\t\t\t<div>\n\t\t\t\t\t<label>ASX 300 only?</label>\n\t\t\t\t\t<input type=\"checkbox\" checked={ is_asx_300 } onChange={ () => set_is_asx_300( !is_asx_300 ) } disabled={ loading } />\n\t\t\t\t</div>\n\t\t\t\t<div>\n\t\t\t\t\t<label>After 4pm yesterday only?</label>\n\t\t\t\t\t<input type=\"checkbox\" checked={ is_after_4pm_yesterday } onChange={ () => set_is_after_4pm_yesterday( !is_after_4pm_yesterday ) } disabled={ loading } />\n\t\t\t\t</div>\n\t\t\t\t<div className={ `${ loading ? \"loading\" : \"loaded\" }` }>\n\t\t\t\t\t{ loading ?\n\t\t\t\t\t\t<>\n\t\t\t\t\t\t\t<p>Connecting</p>\n\t\t\t\t\t\t\t<FontAwesomeIcon icon={ faSpinner } spin size=\"2x\" />\n\t\t\t\t\t\t</>\n\t\t\t\t\t\t: \n\t\t\t\t\t\t<>\n\t\t\t\t\t\t\t<p>Connected</p>\n\t\t\t\t\t\t\t<FontAwesomeIcon icon={ faCheck } />\n\t\t\t\t\t\t</>\n\t\t\t\t\t}\n\t\t\t\t</div>\n\t\t\t</div>\n\n\t\t\t{ !_.isEmpty( unread ) && <h5>Unread:</h5> }\n\t\t\t{ !_.isEmpty( unread ) && _.map( unread, el => <RowCard data={ el } key={ el.id } savedData={ savedData } setSavedData={ setSavedData } /> ) }\n            \n\t\t\t{ !_.isEmpty( saved ) && <h5>Saved:</h5> }\n\t\t\t{ !_.isEmpty( saved ) && _.map( saved, el => <RowCard data={ el } key={ el.id } savedData={ savedData } setSavedData={ setSavedData } /> ) }\n            \n\t\t\t{ !_.isEmpty( read ) && <h5>Read:</h5> }\n\t\t\t{ !_.isEmpty( read ) && _.map( read, el => <RowCard data={ el } key={ el.id } savedData={ savedData } setSavedData={ setSavedData } /> ) }\n\t\t</div>\n\t);\n}\n\nconst RowCard = ({ data, savedData, setSavedData }) => {\n\tconst { id, description, hotcopper_url, stock, time, read, saved } = data;\n\tconst { name, ticker, GICS } = stock;\n\n\tconst markRead = () => setSavedData({ ...savedData, [ id ]: { saved, read: true }});\n\n\tconst parsedTime =  parseJSON( time );\n\n\treturn (\n\t\t<div className=\"card\">\n\t\t\t<div className=\"card-header\">\n\t\t\t\t<p>{ ticker } - { name } - { GICS }</p>\n\t\t\t\t<p>{ formatDistanceToNow( parsedTime ) } ago - { format( parsedTime, \"d LLL @ hh:mm bbb\" )} </p>\n\t\t\t</div>\n\t\t\t<div className=\"card-body\">\n\t\t\t\t<a href={ hotcopper_url } target=\"_blank\" rel=\"noopener noreferrer\" onClick={ markRead }>{ description }<FontAwesomeIcon icon={ faExternalLinkAlt } size=\"xs\" /></a>\n\t\t\t\t<div className=\"read-saved\">\n\t\t\t\t\t<div>\n\t\t\t\t\t\t<label>Pinned</label>\n\t\t\t\t\t\t<input type=\"checkbox\" checked={ saved } onChange={ () => setSavedData({ ...savedData, [ id ]: { read, saved: !saved }}) } />\n\t\t\t\t\t</div>\n\t\t\t\t\t<div>\n\t\t\t\t\t\t<label>Read</label>\n\t\t\t\t\t\t<input type=\"checkbox\" checked={ read } onChange={ markRead } disabled={ read } />\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t);\n};\nRowCard.propTypes = {\n\tdata: PropTypes.object,\n\tsavedData: PropTypes.object,\n\tsetSavedData: PropTypes.func,\n};\n","\nimport React from \"react\";\nimport Home from \"./Home\";\nimport { ApolloProvider } from \"@apollo/react-hooks\";\nimport ApolloClient from \"apollo-client\";\nimport { WebSocketLink } from \"apollo-link-ws\";\nimport { HttpLink } from \"apollo-link-http\";\nimport { split } from \"apollo-link\";\nimport { getMainDefinition } from \"apollo-utilities\";\nimport { InMemoryCache } from \"apollo-cache-inmemory\";\n\nexport default function App () {\n\n\tconst httpLink = new HttpLink({\n\t\turi: \"https://quiet-river-86309.herokuapp.com/v1/graphql\",\n\t});\n    \n\tconst wsLink = new WebSocketLink({\n\t\turi: \"wss://quiet-river-86309.herokuapp.com/v1/graphql\",\n\t\toptions: {\n\t\t\treconnect: true,\n\t\t\ttimeout: 30000,\n\t\t},\n\t});\n\n\tconst link = split(\n\t\t({ query }) => {\n\t\t\tconst { kind, operation } = getMainDefinition( query );\n\t\t\treturn kind === \"OperationDefinition\" && operation === \"subscription\";\n\t\t},\n\t\twsLink,\n\t\thttpLink,\n\t);\n\n\tconst client = new ApolloClient({\n\t\tlink,\n\t\tcache: new InMemoryCache(),\n\t});\n\n\treturn (\n\t\t<ApolloProvider client={ client }>\n\t\t\t<Home />\n\t\t</ApolloProvider>\n\t);\n}\n","\nimport React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport \"./index.scss\";\nimport App from \"./App\";\n\nReactDOM.render(\n\t<React.StrictMode>\n\t\t<App />\n\t</React.StrictMode>,\n\tdocument.getElementById( \"root\" ),\n);\n"],"sourceRoot":""}