(this["webpackJsonpasx-annoucements"]=this["webpackJsonpasx-annoucements"]||[]).push([[0],{106:function(e,t,a){"use strict";a.r(t);var c,n=a(4),r=a.n(n),s=a(69),i=a.n(s),o=(a(82),a(51)),d=a.n(o),j=a(70),l=a(34),u=a(33),b=a(25),p=a(71),m=(a(84),a(31)),O=a(23),h=a(24),v=a(10),x=a.n(v),_=a(72),f=a.n(_),k=a(109),y=a(112),g=a(113),w=a(111),S=a(110),E=a(114),N=a(73),C=a.n(N),D=a(38),M=a.n(D),A=a(3),z=f()(c||(c=Object(p.a)(["\nsubscription SubcribeAnnouncements ( $time_before: timestamptz!, $is_price_sensitive: [Boolean!], $market_cap_lower: numeric, $market_cap_upper: numeric ) {\n\tannouncements( \n\t\twhere: { \n            time: { _gte: $time_before },\n\t\t\tis_price_sensitive: { _in: $is_price_sensitive },\n            stock: { market_cap: { _gte: $market_cap_lower, _lte: $market_cap_upper }}\n\t\t},\n\t\torder_by: { time: desc }\n\t) {\n\t\tann_download_url\n\t\tdescription\n\t\thotcopper_url\n\t\tid time\n\t\tis_price_sensitive\n\t\tstock {\n\t\t\tname ticker\n\t\t\tGICS exchange\n            market_cap\n\t\t}\n\t}\n}"]))),$=[{label:"Micro Cap",value:"micro"},{label:"Small Cap",value:"small"},{label:"Medium Cap",value:"medium"},{label:"Large Cap",value:"large"}],q={micro:{lower:0,upper:2e7},small:{lower:2e7,upper:2e9},medium:{lower:2e9,upper:1e10},large:{lower:1e10,upper:1e18}};function I(){var e=Object(n.useState)(Object(b.a)(Object(b.a)({history:{},is_price_sensitive:!0,market_cap:"small",is_after_4pm_yesterday:!0,filtered_tickers:[]},M.a.getItem("settings")),{},{updateSettings:function(e,t){return c((function(a){return Object(b.a)(Object(b.a)({},a),{},Object(u.a)({},e,t))}))}})),t=Object(l.a)(e,2),a=t[0],c=t[1],r=a.history,s=a.is_price_sensitive,i=a.market_cap,o=a.is_after_4pm_yesterday,d=a.filtered_tickers,j=a.updateSettings,p=Object(n.useState)(new Date),v=Object(l.a)(p,2),_=v[0],f=v[1],S=Object(n.useState)(!1),E=Object(l.a)(S,2),N=E[0],C=E[1];Object(n.useEffect)((function(){N||C(setInterval((function(){return f(new Date)}),1e3))}),[N]);var D=o?Object(k.a)(Object(y.a)(Object(g.a)(new Date,1),{hours:16,minutes:0,seconds:0})):Object(k.a)(0),I=Object(m.useSubscription)(z,{variables:{is_price_sensitive:s?[!0]:[!0,!1],time_before:D,market_cap_lower:q[i].lower,market_cap_upper:q[i].upper}}),P=I.data,R=I.loading,B=x.a.get(P,"announcements"),F=x.a.isEmpty(d)?B:x.a.filter(B,(function(e){return x.a.includes(d,x.a.get(e,"stock.ticker"))})),G=x.a.map(F,(function(e){var t=e.id;return Object(b.a)(Object(b.a)({},e),{},{read:x.a.get(r,[t,"read"],!1),saved:x.a.get(r,[t,"saved"],!1)})})),H=x.a.filter(G,{read:!1,saved:!1}),J=x.a.filter(G,{saved:!0}),L=x.a.filter(G,{read:!0,saved:!1});return Object(n.useEffect)((function(){r||j("history",{}),M.a.setItem("settings",x.a.omit(a,["updateSettings"]))}),[a]),Object(n.useEffect)((function(){document.title="ASX  Ann Feed (".concat(x.a.size(H)," unread)")}),[H]),Object(A.jsxs)("div",{className:"body",children:[Object(A.jsxs)("div",{className:"header",children:[Object(A.jsx)("h3",{children:Object(w.a)(_,"h:mm:ss aaa '-' EE do MMM")}),Object(A.jsx)("h2",{children:"ASX Recent Announcement Feed"}),Object(A.jsx)("p",{children:"A scraped collection of ASX announcements, data live updated every minute during peak hours."}),Object(A.jsx)("p",{children:"History of read and saved annoucments saved locally to your browser."})]}),Object(A.jsxs)("div",{className:"inputs-box-row",children:[Object(A.jsxs)("div",{onClick:function(){return j("is_price_sensitive",!s)},children:[Object(A.jsx)("p",{children:"Price sensitive only?"}),s?Object(A.jsx)(O.a,{icon:h.a}):Object(A.jsx)(O.a,{icon:h.d,className:"unchecked"})]}),Object(A.jsxs)("div",{children:[Object(A.jsx)("p",{children:"Market cap"}),Object(A.jsx)("select",{value:i,onChange:function(e){return j("market_cap",e.target.value)},children:!x.a.isEmpty($)&&x.a.map($,(function(e){var t=e.value,a=e.label;return Object(A.jsx)("option",{value:t,children:a},t)}))})]}),Object(A.jsxs)("div",{onClick:function(){return j("is_after_4pm_yesterday",!o)},children:[Object(A.jsx)("p",{children:"After 4pm yesterday only?"}),o?Object(A.jsx)(O.a,{icon:h.a}):Object(A.jsx)(O.a,{icon:h.d,className:"unchecked"})]})]}),R&&Object(A.jsx)("div",{className:"loader",children:Object(A.jsx)(O.a,{icon:h.c,spin:!0,size:"3x"})}),!R&&x.a.isEmpty(H)&&x.a.isEmpty(J)&&x.a.isEmpty(L)&&Object(A.jsx)("p",{className:"-colour-tertiary",children:"No matching announcements"}),!x.a.isEmpty(J)&&Object(A.jsxs)("h5",{children:["Saved (",x.a.size(J),"):"]}),!x.a.isEmpty(J)&&x.a.map(J,(function(e){return Object(A.jsx)(X,{data:e,savedData:r,setSavedData:function(e){return j("history",e)}},e.id)})),!x.a.isEmpty(H)&&Object(A.jsxs)("h5",{children:["Unread (",x.a.size(H),"):"]}),!x.a.isEmpty(H)&&x.a.map(H,(function(e){return Object(A.jsx)(X,{data:e,savedData:r,setSavedData:function(e){return j("history",e)}},e.id)})),!x.a.isEmpty(L)&&Object(A.jsxs)("h5",{children:["Read (",x.a.size(L),"):"]}),!x.a.isEmpty(L)&&x.a.map(L,(function(e){return Object(A.jsx)(X,{data:e,savedData:r,setSavedData:function(e){return j("history",e)}},e.id)}))]})}var X=function(e){var t=e.data,a=e.savedData,c=e.setSavedData,n=t.id,r=t.description,s=t.hotcopper_url,i=t.stock,o=t.time,d=t.read,j=t.saved,l=t.is_price_sensitive,p=i.name,m=i.ticker,v=i.exchange,_=i.market_cap,f=i.GICS,k=Object(S.a)(o),y=x.a.compact(["Market Cap: ".concat(C()(_).format("0.0a")),!!l&&"Price Sensitive"]).join(" - "),g=Object(E.a)(new Date,k)<=20;return Object(A.jsxs)("div",{className:"card",children:[Object(A.jsxs)("div",{className:"card-header",children:[Object(A.jsxs)("div",{children:[Object(A.jsxs)("a",{href:"https://finance.yahoo.com/quote/".concat(m,".AX"),target:"_blank",rel:"noopener noreferrer",children:[v,":",m,p&&" - ".concat(p),Object(A.jsx)(O.a,{icon:h.b,size:"xs"})]}),Object(A.jsx)("p",{children:f}),Object(A.jsx)("p",{children:y})]}),Object(A.jsx)("p",{children:Object(w.a)(k,"h:mm aaa '-' EE do MMM")})]}),Object(A.jsxs)("div",{className:"card-body",children:[Object(A.jsxs)("a",{href:s,target:"_blank",rel:"noopener noreferrer",children:[r,Object(A.jsx)(O.a,{icon:h.b,size:"xs",className:g?"-colour-tertiary":""})]}),Object(A.jsxs)("div",{className:"inputs-box-column",children:[Object(A.jsxs)("div",{onClick:function(){return c(Object(b.a)(Object(b.a)({},a),{},Object(u.a)({},n,{read:!0,saved:!j})))},children:[Object(A.jsx)("label",{children:"Saved"}),j?Object(A.jsx)(O.a,{icon:h.a}):Object(A.jsx)(O.a,{icon:h.d,className:"unchecked"})]}),Object(A.jsxs)("div",{onClick:function(){return c(Object(b.a)(Object(b.a)({},a),{},Object(u.a)({},n,{saved:j,read:!d})))},children:[Object(A.jsx)("label",{children:"Read"}),d?Object(A.jsx)(O.a,{icon:h.a}):Object(A.jsx)(O.a,{icon:h.d,className:"unchecked"})]})]})]})]})},P=a(1),R=a(76),B=a(54);function F(){var e=Object(n.useState)(!1),t=Object(l.a)(e,2),a=t[0],c=t[1];return Object(n.useEffect)((function(){Object(j.a)(d.a.mark((function e(){var t,a,n,r,s,i;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=new m.InMemoryCache,a=new B.a({storage:new B.b(M.a),trigger:"write",cache:t}),e.next=4,a.restore();case 4:n=new m.HttpLink({uri:"https://quiet-river-86309.herokuapp.com/v1/graphql"}),r=new R.a({uri:"wss://quiet-river-86309.herokuapp.com/v1/graphql",options:{reconnect:!0,timeout:3e4}}),s=Object(m.split)((function(e){var t=e.query,a=Object(P.q)(t),c=a.kind,n=a.operation;return"OperationDefinition"===c&&"subscription"===n}),r,n),i=new m.ApolloClient({link:s,cache:t}),c(i);case 9:case"end":return e.stop()}}),e)})))()}),[]),a?Object(A.jsx)(m.ApolloProvider,{client:a,children:Object(A.jsx)(I,{})}):null}i.a.render(Object(A.jsx)(r.a.StrictMode,{children:Object(A.jsx)(F,{})}),document.getElementById("root"))},82:function(e,t,a){}},[[106,1,2]]]);
//# sourceMappingURL=main.e82e4feb.chunk.js.map