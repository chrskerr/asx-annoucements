(this["webpackJsonpasx-annoucements"]=this["webpackJsonpasx-annoucements"]||[]).push([[4],{106:function(e,t,a){"use strict";a.r(t),a.d(t,"default",(function(){return M}));var c,n=a(37),s=a.n(n),r=a(41),i=a(89),d=a(91),o=a(55),j=a(92),l=a(4),u=(a(93),a(94)),b=a(104),p=a(101),m=a.n(p),O=a(22),h=a(107),v=a(111),x=a(110),f=a(108),_=a(112),y=a(109),k=a(103),g=a.n(k),S=a(49),w=a.n(S),E=a(20),N=Object(O.gql)(c||(c=Object(j.a)(["\nsubscription SubcribeAnnouncements ( $time_before: timestamptz!, $is_price_sensitive: [Boolean!], $market_cap_lower: numeric, $market_cap_upper: numeric ) {\n\tannouncements( \n\t\twhere: { \n            time: { _gte: $time_before },\n\t\t\tis_price_sensitive: { _in: $is_price_sensitive },\n            stock: { market_cap: { _gte: $market_cap_lower, _lte: $market_cap_upper }}\n\t\t},\n\t\torder_by: { time: desc }\n\t) {\n\t\tann_download_url\n\t\tdescription\n\t\thotcopper_url\n\t\tid time\n\t\tis_price_sensitive\n\t\tstock {\n\t\t\tname ticker\n\t\t\tGICS exchange\n            market_cap\n\t\t}\n\t}\n}"]))),C=[{label:"Micro Cap",value:"micro"},{label:"Small Cap",value:"small"},{label:"Medium Cap",value:"medium"},{label:"Large Cap",value:"large"}],D={micro:{lower:0,upper:2e7},small:{lower:2e7,upper:2e9},medium:{lower:2e9,upper:1e10},large:{lower:1e10,upper:1e18}};function M(){var e=Object(l.useState)({loaded:!1,history:{},is_price_sensitive:!0,is_after_4pm_yesterday:!0,market_cap:"small",updateSettings:function(e,t){return c((function(a){return Object(d.a)(Object(d.a)({},a),{},Object(i.a)({},e,t))}))}}),t=Object(o.a)(e,2),a=t[0],c=t[1],n=a.loaded,j=a.history,p=a.is_price_sensitive,f=a.is_after_4pm_yesterday,_=a.market_cap,y=a.updateSettings;Object(l.useEffect)((function(){Object(r.a)(s.a.mark((function e(){var t;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,w.a.getItem("settings");case 2:t=e.sent,c((function(e){return Object(d.a)(Object(d.a)(Object(d.a)({},e),t),{},{loaded:!0})}));case 4:case"end":return e.stop()}}),e)})))()}),[]);var k=f?Object(h.a)(Object(v.a)(Object(x.a)(new Date,1),{hours:16,minutes:0,seconds:0})):Object(h.a)(0),g=Object(O.useSubscription)(N,{variables:{is_price_sensitive:p?[!0]:[!0,!1],time_before:k,market_cap_lower:m.a.get(D,[_,"lower"]),market_cap_upper:m.a.get(D,[_,"upper"])}}),S=g.data,M=g.loading,$=m.a.get(S,"announcements"),I=m.a.map($,(function(e){var t=e.id;return Object(d.a)(Object(d.a)({},e),{},{read:m.a.get(j,[t,"read"],!1),saved:m.a.get(j,[t,"saved"],!1)})})),R=m.a.filter(I,{read:!1,saved:!1}),X=m.a.filter(I,{saved:!0}),q=m.a.filter(I,{read:!0,saved:!1});Object(l.useEffect)((function(){j||y("history",{}),w.a.setItem("settings",m.a.omit(a,["updateSettings"]))}),[a]),Object(l.useEffect)((function(){document.title="ASX  Ann Feed (".concat(m.a.size(R)," unread)")}),[R]);return n?Object(E.jsxs)("div",{className:"body",children:[Object(E.jsxs)("div",{className:"header",children:[Object(E.jsx)(z,{}),Object(E.jsx)("h2",{children:"ASX Recent Announcement Feed"}),Object(E.jsx)("p",{children:"A scraped collection of ASX announcements, data live updated every minute during peak hours."}),Object(E.jsx)("p",{children:"History of read and saved annoucments saved locally to your browser."})]}),Object(E.jsxs)("div",{className:"inputs-box-row",children:[Object(E.jsxs)("div",{onClick:function(){return y("is_price_sensitive",!p)},children:[Object(E.jsx)("p",{children:"Price sensitive only?"}),p?Object(E.jsx)(u.a,{icon:b.a}):Object(E.jsx)(u.a,{icon:b.d,className:"unchecked"})]}),Object(E.jsxs)("div",{children:[Object(E.jsx)("p",{children:"Market cap"}),Object(E.jsx)("select",{value:_,onChange:function(e){return y("market_cap",e.target.value)},children:!m.a.isEmpty(C)&&m.a.map(C,(function(e){var t=e.value,a=e.label;return Object(E.jsx)("option",{value:t,children:a},t)}))})]}),Object(E.jsxs)("div",{onClick:function(){return y("is_after_4pm_yesterday",!f)},children:[Object(E.jsx)("p",{children:"After 4pm yesterday only?"}),f?Object(E.jsx)(u.a,{icon:b.a}):Object(E.jsx)(u.a,{icon:b.d,className:"unchecked"})]})]}),M&&Object(E.jsx)("div",{className:"loader",children:Object(E.jsx)(u.a,{icon:b.c,spin:!0,size:"3x"})}),!M&&m.a.isEmpty(R)&&Object(E.jsx)("div",{className:"mark-read-button",children:Object(E.jsx)("button",{onClick:function(){y("history",m.a.reduce($,(function(e,t){var a=t.id;return Object(d.a)(Object(d.a)({},e),{},Object(i.a)({},a,{read:!0,saved:m.a.get(j,[a,"saved"],!1)}))}),j))},children:"Mark All Read"})}),!M&&m.a.isEmpty(R)&&m.a.isEmpty(X)&&m.a.isEmpty(q)&&Object(E.jsx)("p",{className:"-colour-tertiary",children:"No matching announcements"}),!m.a.isEmpty(X)&&Object(E.jsxs)("h5",{children:["Saved (",m.a.size(X),"):"]}),!m.a.isEmpty(X)&&m.a.map(X,(function(e){return Object(E.jsx)(A,{data:e,savedData:j,setSavedData:function(e){return y("history",e)}},e.id)})),!m.a.isEmpty(R)&&Object(E.jsxs)("h5",{children:["Unread (",m.a.size(R),"):"]}),!m.a.isEmpty(R)&&m.a.map(R,(function(e){return Object(E.jsx)(A,{data:e,savedData:j,setSavedData:function(e){return y("history",e)}},e.id)})),!m.a.isEmpty(q)&&Object(E.jsxs)("h5",{children:["Read (",m.a.size(q),"):"]}),!m.a.isEmpty(q)&&m.a.map(q,(function(e){return Object(E.jsx)(A,{data:e,savedData:j,setSavedData:function(e){return y("history",e)}},e.id)}))]}):null}var A=function(e){var t=e.data,a=e.savedData,c=e.setSavedData,n=t.id,s=t.description,r=t.hotcopper_url,o=t.stock,j=t.time,l=t.read,p=t.saved,O=t.is_price_sensitive,h=o.name,v=o.ticker,x=o.exchange,k=o.market_cap,S=o.GICS,w=Object(f.a)(j),N=m.a.compact(["Market Cap: ".concat(g()(k).format("0.0a")),!!O&&"Price Sensitive"]).join(" - "),C=Object(_.a)(new Date,w)<=20;return Object(E.jsxs)("div",{className:"card",children:[Object(E.jsxs)("div",{className:"card-header",children:[Object(E.jsxs)("div",{children:[Object(E.jsxs)("a",{href:"https://finance.yahoo.com/quote/".concat(v,".AX"),target:"_blank",rel:"noopener noreferrer",children:[x,":",v,h&&" - ".concat(h),Object(E.jsx)(u.a,{icon:b.b,size:"xs"})]}),Object(E.jsx)("p",{children:S}),Object(E.jsx)("p",{children:N})]}),Object(E.jsx)("p",{children:Object(y.a)(w,"h:mm aaa '-' EE do MMM")})]}),Object(E.jsxs)("div",{className:"card-body",children:[Object(E.jsxs)("a",{href:r,target:"_blank",rel:"noopener noreferrer",children:[s,Object(E.jsx)(u.a,{icon:b.b,size:"xs",className:C?"-colour-tertiary":""})]}),Object(E.jsxs)("div",{className:"inputs-box-column",children:[Object(E.jsxs)("div",{onClick:function(){return c(Object(d.a)(Object(d.a)({},a),{},Object(i.a)({},n,{read:!0,saved:!p})))},children:[Object(E.jsx)("label",{children:"Saved"}),p?Object(E.jsx)(u.a,{icon:b.a}):Object(E.jsx)(u.a,{icon:b.d,className:"unchecked"})]}),Object(E.jsxs)("div",{onClick:function(){return c(Object(d.a)(Object(d.a)({},a),{},Object(i.a)({},n,{saved:p,read:!l})))},children:[Object(E.jsx)("label",{children:"Read"}),l?Object(E.jsx)(u.a,{icon:b.a}):Object(E.jsx)(u.a,{icon:b.d,className:"unchecked"})]})]})]})]})},z=function(){var e=Object(l.useState)(new Date),t=Object(o.a)(e,2),a=t[0],c=t[1],n=Object(l.useState)(!1),s=Object(o.a)(n,2),r=s[0],i=s[1];return Object(l.useEffect)((function(){return r||i(setInterval((function(){return c(new Date)}),1e3)),function(){r&&clearInterval(r)}}),[r]),Object(E.jsx)("h3",{children:Object(y.a)(a,"h:mm:ss aaa '-' EE do MMM")})}}}]);
//# sourceMappingURL=4.5f5b6a6e.chunk.js.map